axis.ticks.y = element_blank()) +
coord_flip()
# Confidence per expertise
confi_exp <- df_long_clean %>%
group_by(expertise, confidence) %>%
summarize(N = n()) %>%
mutate(pct = round(N / sum(N) * 100, 1)) %>%
select(expertise, confidence, pct)
confi_exp <- within(confi_exp, confidence <- factor(confidence, levels = c("high_confidence", "low_confidence", "ambiguous")))
confi_exp <- within(confi_exp, expertise <- factor(expertise, levels = c("some_experience", "no_experience")))
# p <- ggplot(confi_exp, aes(x = confidence, y = pct, fill = expertise))
# p + geom_bar(stat = "identity", position = "dodge2", alpha = .9) +
#     scale_fill_brewer(type = "qual", palette = "Dark2", labels = c("some experience", "no experience")) +
#     scale_y_continuous(labels = scales::label_percent(scale = 1),
#                        expand = expansion(mult = c(0, 0.05))) +
#     scale_x_discrete(labels = c("High Confidence", "Low Confidence", "Ambiguous")) +
#     labs(x = NULL, y = "Confidence",
#          fill = "Expertise",
#          title = "Confidence per expertise (%)") +
#     geom_text(aes(y = pct, label = pct), position = position_dodge2(width = 1), vjust = -0.40, size = rel(3), family = dviz_font_family) +
#     theme_dviz_hgrid() +
#     theme(legend.position = "top",
#           axis.line.x.bottom = element_line(size = .5, colour = "black"),
#           axis.ticks.x = element_blank())
p <- ggplot(confi_exp, aes(x = expertise, y = pct, fill = confidence))
p + geom_bar(stat = "identity", color = "gray80") +
scale_fill_viridis_d("Confidence", labels = c("high confidence", "low confidence", "ambiguous")) +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
scale_x_discrete(labels = c("Some Experience", "No Experience")) +
labs(x = NULL, y = "Participants",
fill = "Confidence",
title = "Confidence level per expertise") +
theme(legend.position = "top",
axis.ticks.y = element_blank()) +
coord_flip()
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = NULL, y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner (northwestern quadrant)") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_dviz_hgrid() +
theme(
legend.position = "NULL",
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy mean per light direction and hemisphere
accu_resp_n_hem <- accu_resp_north %>%
filter(ds_owner == "j" | ds_owner == "g") %>%
group_by(light_dir) %>%
summarise(north = mean(mean))
accu_resp_s_hem <- accu_resp_north %>%
filter(ds_owner == "v" | ds_owner == "a") %>%
group_by(light_dir) %>%
summarise(south = mean(mean))
accu_resp_hem <- left_join(accu_resp_n_hem, accu_resp_s_hem, by = "light_dir")
accu_resp_hem_long <- accu_resp_hem %>% pivot_longer(-light_dir, names_to = "hemisphere", values_to = "mean")
p <- ggplot(accu_resp_hem_long, aes(x = light_dir, y = mean, fill = hemisphere))
p + geom_bar(stat = "identity", position = "dodge2", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05)),
limits = c(0, 100)) +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = -0.40, size = rel(3), family = dviz_font_family) +
labs(x = NULL, y = "Mean Accuracy",
fill = "Hemisphere",
title = "Mean accuracy per hemisphere (northwestern quadrant)") +
theme_dviz_hgrid() +
theme(legend.position = "top",
axis.line.x.bottom = element_line(size = .5, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per participant and handedness
accu_hand_l <- df_long_clean %>%
filter(accuracy == "yes",
handedness == "l") %>%
group_by(ds_owner, id, handedness) %>%
mutate(accu_count = n(),
accu_pct = round(accu_count / 40 * 100, 1)) %>%
ungroup() %>%
select(ds_owner, id, handedness, accu_count, accu_pct)
accu_hand_r <- df_long_clean %>%
filter(accuracy == "yes",
handedness == "r") %>%
group_by(ds_owner, id, handedness) %>%
mutate(accu_count = n(),
accu_pct = round(accu_count / 40 * 100, 1)) %>%
ungroup() %>%
select(ds_owner, id, handedness, accu_count, accu_pct)
accu_hand_b <- df_long_clean %>%
filter(accuracy == "yes",
handedness == "b") %>%
group_by(ds_owner, id, handedness) %>%
mutate(accu_count = n(),
accu_pct = round(accu_count / 40 * 100, 1)) %>%
ungroup() %>%
select(ds_owner, id, handedness, accu_count, accu_pct)
# Calculating accuracy per handedness and respond
accu_resp_hand_l <- df_long_clean %>%
filter(accuracy == "yes",
handedness == "l" | handedness == "b") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_left = accu_count / 34 * 100) %>%
ungroup() %>%
select(landform,land_dir, light_dir, accu_left)
accu_resp_hand_r <- df_long_clean %>%
filter(accuracy == "yes",
handedness == "r") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_right = accu_count / 156 * 100) %>%
ungroup() %>%
select(landform, land_dir, light_dir, accu_right)
accu_resp_hand <-  accu_resp_hand_l %>% left_join(accu_resp_hand_r)
# Calculating accuracy per handedness and respond (northern light direction)
accu_hand_l_north<- accu_resp_hand %>%
group_by(light_dir) %>%
summarise(left = mean(accu_left))
accu_hand_r_north<- accu_resp_hand %>%
group_by(light_dir) %>%
summarise(right = mean(accu_right))
accu_hand_north <- accu_hand_l_north %>% left_join(accu_hand_r_north)
accu_hand_north_long <- accu_hand_north %>% pivot_longer(-light_dir, names_to = "handedness", values_to = "mean")
accu_hand_north_long <- within(accu_hand_north_long, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
p <- ggplot(accu_hand_north_long, aes(x = light_dir, y = mean, fill = handedness))
p + geom_bar(stat = "identity", position = "dodge2", alpha =.9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05)),
limits = c(0, 100)) +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = -0.40, size = rel(3), family = dviz_font_family) +
labs(x = NULL, y = "Mean Accuracy",
fill = "Handedness",
title = "Mean accuracy per handedness (northwestern quadrant)") +
theme_dviz_hgrid() +
theme(legend.position = "top",
axis.line.x.bottom = element_line(size = .5, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per gender and respond
accu_gender_m <- df_long_clean %>%
filter(accuracy == "yes",
gender == "m") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(male_pct = accu_count / 104 * 100) %>%
select(landform, land_dir, light_dir, male_pct)
accu_gender_f <- df_long %>%
filter(accuracy == "yes",
gender == "f") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(female_pct = accu_count / 86 * 100) %>%
select(landform, land_dir, light_dir, female_pct)
accu_gender <- accu_gender_m %>% left_join(accu_gender_f)
# Calculating accuracy per gender and respond (northern light direction)
accu_gender_north_m <- accu_gender %>%
group_by(light_dir) %>%
summarise(male = mean(male_pct))
accu_gender_north_f <- accu_gender %>%
group_by(light_dir) %>%
summarise(female = mean(female_pct))
accu_gender_north <- accu_gender_north_m %>% left_join(accu_gender_north_f)
accu_gender_north_long <- accu_gender_north %>% pivot_longer(-light_dir, names_to = "gender", values_to = "mean")
accu_gender_north_long <- within(accu_gender_north_long, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
p <- ggplot(accu_gender_north_long, aes(x = light_dir, y = mean, fill = gender))
p + geom_bar(stat = "identity", position = "dodge2", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05)),
limits = c(0, 100)) +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = -0.40, size = rel(3), family = dviz_font_family) +
labs(x = NULL, y = "Mean Accuracy",
fill = "Gender",
title = "Mean accuracy per gender (northwestern quadrant)") +
theme_dviz_hgrid() +
theme(legend.position = "top",
axis.line.x.bottom = element_line(size = .5, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per expertise and respond
accu_exp_some <- df_long_clean %>%
filter(accuracy == "yes",
expertise == "some_experience") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(some_pct = accu_count / 40 * 100) %>%
select(landform, land_dir, light_dir, some_pct)
accu_exp_no <- df_long_clean %>%
filter(accuracy == "yes",
expertise == "no_experience") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(no_pct = accu_count / 150 * 100) %>%
select(landform, land_dir, light_dir, no_pct)
accu_exp <- accu_exp_some %>% left_join(accu_exp_no)
# Calculating accuracy per expertise and respond (northern light direction)
accu_exp_some_north <- accu_exp %>%
group_by(light_dir) %>%
summarise(some = mean(some_pct))
accu_exp_no_north <- accu_exp %>%
group_by(light_dir) %>%
summarise(no = mean(no_pct))
accu_exp_north <- accu_exp_some_north %>% left_join(accu_exp_no_north)
accu_exp_north_long <- accu_exp_north %>% pivot_longer(-light_dir, names_to = "expertise", values_to = "mean")
accu_exp_north_long <- within(accu_exp_north_long, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
p <- ggplot(accu_exp_north_long, aes(x = light_dir, y = mean, fill = expertise))
p + geom_bar(stat = "identity", position = "dodge2", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05)),
limits = c(0, 100)) +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = -0.40, size = rel(3), family = dviz_font_family) +
labs(x = NULL, y = "Mean Accuracy",
fill = "Expertise",
title = "Mean accuracy per expertise (northwestern quadrant)") +
theme_dviz_hgrid() +
theme(legend.position = "top",
axis.line.x.bottom = element_line(size = .5, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = NULL, y = "Mean",
fill = "Light Direction",
title = "Mean accuracy per data set owner (NW)") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_dviz_hgrid() +
theme(
legend.position = "NULL",
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy mean per light direction and hemisphere
accu_resp_n_hem <- accu_resp_north %>%
filter(ds_owner == "j" | ds_owner == "g") %>%
group_by(light_dir) %>%
summarise(north = mean(mean))
accu_resp_s_hem <- accu_resp_north %>%
filter(ds_owner == "v" | ds_owner == "a") %>%
group_by(light_dir) %>%
summarise(south = mean(mean))
accu_resp_hem <- left_join(accu_resp_n_hem, accu_resp_s_hem, by = "light_dir")
accu_resp_hem_long <- accu_resp_hem %>% pivot_longer(-light_dir, names_to = "hemisphere", values_to = "mean")
p <- ggplot(accu_resp_hem_long, aes(x = light_dir, y = mean, fill = hemisphere))
p + geom_bar(stat = "identity", position = "dodge2", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05)),
limits = c(0, 100)) +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = -0.40, size = rel(3), family = dviz_font_family) +
labs(x = NULL, y = "Mean",
fill = "Hemisphere",
title = "Mean accuracy per hemisphere (NW)") +
theme_dviz_hgrid() +
theme(legend.position = "top",
axis.line.x.bottom = element_line(size = .5, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per participant and handedness
accu_hand_l <- df_long_clean %>%
filter(accuracy == "yes",
handedness == "l") %>%
group_by(ds_owner, id, handedness) %>%
mutate(accu_count = n(),
accu_pct = round(accu_count / 40 * 100, 1)) %>%
ungroup() %>%
select(ds_owner, id, handedness, accu_count, accu_pct)
accu_hand_r <- df_long_clean %>%
filter(accuracy == "yes",
handedness == "r") %>%
group_by(ds_owner, id, handedness) %>%
mutate(accu_count = n(),
accu_pct = round(accu_count / 40 * 100, 1)) %>%
ungroup() %>%
select(ds_owner, id, handedness, accu_count, accu_pct)
accu_hand_b <- df_long_clean %>%
filter(accuracy == "yes",
handedness == "b") %>%
group_by(ds_owner, id, handedness) %>%
mutate(accu_count = n(),
accu_pct = round(accu_count / 40 * 100, 1)) %>%
ungroup() %>%
select(ds_owner, id, handedness, accu_count, accu_pct)
# Calculating accuracy per handedness and respond
accu_resp_hand_l <- df_long_clean %>%
filter(accuracy == "yes",
handedness == "l" | handedness == "b") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_left = accu_count / 34 * 100) %>%
ungroup() %>%
select(landform,land_dir, light_dir, accu_left)
accu_resp_hand_r <- df_long_clean %>%
filter(accuracy == "yes",
handedness == "r") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_right = accu_count / 156 * 100) %>%
ungroup() %>%
select(landform, land_dir, light_dir, accu_right)
accu_resp_hand <-  accu_resp_hand_l %>% left_join(accu_resp_hand_r)
# Calculating accuracy per handedness and respond (northern light direction)
accu_hand_l_north<- accu_resp_hand %>%
group_by(light_dir) %>%
summarise(left = mean(accu_left))
accu_hand_r_north<- accu_resp_hand %>%
group_by(light_dir) %>%
summarise(right = mean(accu_right))
accu_hand_north <- accu_hand_l_north %>% left_join(accu_hand_r_north)
accu_hand_north_long <- accu_hand_north %>% pivot_longer(-light_dir, names_to = "handedness", values_to = "mean")
accu_hand_north_long <- within(accu_hand_north_long, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
p <- ggplot(accu_hand_north_long, aes(x = light_dir, y = mean, fill = handedness))
p + geom_bar(stat = "identity", position = "dodge2", alpha =.9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05)),
limits = c(0, 100)) +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = -0.40, size = rel(3), family = dviz_font_family) +
labs(x = NULL, y = "Mean",
fill = "Handedness",
title = "Mean accuracy per handedness (NW)") +
theme_dviz_hgrid() +
theme(legend.position = "top",
axis.line.x.bottom = element_line(size = .5, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per gender and respond
accu_gender_m <- df_long_clean %>%
filter(accuracy == "yes",
gender == "m") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(male_pct = accu_count / 104 * 100) %>%
select(landform, land_dir, light_dir, male_pct)
accu_gender_f <- df_long %>%
filter(accuracy == "yes",
gender == "f") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(female_pct = accu_count / 86 * 100) %>%
select(landform, land_dir, light_dir, female_pct)
accu_gender <- accu_gender_m %>% left_join(accu_gender_f)
# Calculating accuracy per gender and respond (northern light direction)
accu_gender_north_m <- accu_gender %>%
group_by(light_dir) %>%
summarise(male = mean(male_pct))
accu_gender_north_f <- accu_gender %>%
group_by(light_dir) %>%
summarise(female = mean(female_pct))
accu_gender_north <- accu_gender_north_m %>% left_join(accu_gender_north_f)
accu_gender_north_long <- accu_gender_north %>% pivot_longer(-light_dir, names_to = "gender", values_to = "mean")
accu_gender_north_long <- within(accu_gender_north_long, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
p <- ggplot(accu_gender_north_long, aes(x = light_dir, y = mean, fill = gender))
p + geom_bar(stat = "identity", position = "dodge2", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05)),
limits = c(0, 100)) +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = -0.40, size = rel(3), family = dviz_font_family) +
labs(x = NULL, y = "Mean",
fill = "Gender",
title = "Mean accuracy per gender (NW)") +
theme_dviz_hgrid() +
theme(legend.position = "top",
axis.line.x.bottom = element_line(size = .5, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per expertise and respond
accu_exp_some <- df_long_clean %>%
filter(accuracy == "yes",
expertise == "some_experience") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(some_pct = accu_count / 40 * 100) %>%
select(landform, land_dir, light_dir, some_pct)
accu_exp_no <- df_long_clean %>%
filter(accuracy == "yes",
expertise == "no_experience") %>%
group_by(landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(no_pct = accu_count / 150 * 100) %>%
select(landform, land_dir, light_dir, no_pct)
accu_exp <- accu_exp_some %>% left_join(accu_exp_no)
# Calculating accuracy per expertise and respond (northern light direction)
accu_exp_some_north <- accu_exp %>%
group_by(light_dir) %>%
summarise(some = mean(some_pct))
accu_exp_no_north <- accu_exp %>%
group_by(light_dir) %>%
summarise(no = mean(no_pct))
accu_exp_north <- accu_exp_some_north %>% left_join(accu_exp_no_north)
accu_exp_north_long <- accu_exp_north %>% pivot_longer(-light_dir, names_to = "expertise", values_to = "mean")
accu_exp_north_long <- within(accu_exp_north_long, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
p <- ggplot(accu_exp_north_long, aes(x = light_dir, y = mean, fill = expertise))
p + geom_bar(stat = "identity", position = "dodge2", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05)),
limits = c(0, 100)) +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = -0.40, size = rel(3), family = dviz_font_family) +
labs(x = NULL, y = "Mean",
fill = "Expertise",
title = "Mean accuracy per expertise (NW)") +
theme_dviz_hgrid() +
theme(legend.position = "top",
axis.line.x.bottom = element_line(size = .5, color = "black"),
axis.ticks.x = element_blank())
accu_confi_yes <- df_long_clean %>%
filter(accuracy == "yes") %>%
group_by(light_dir, confidence) %>%
summarize(N = n()) %>%
mutate(pct = round(N / sum(N) * 100, 1)) %>%
select(light_dir, confidence, pct)
accu_confi_yes <- within(accu_confi_yes, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
accu_confi_no <- df_long_clean %>%
filter(accuracy == "no") %>%
group_by(light_dir, confidence) %>%
summarize(N = n()) %>%
mutate(pct = round(N / sum(N) * 100, 1)) %>%
select(light_dir, confidence, pct)
accu_confi_no <- within(accu_confi_no, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
p <- ggplot(accu_confi_yes, aes(x = light_dir, y = pct, fill = confidence))
p + geom_bar(stat = "identity", color = "gray80") +
scale_fill_viridis_d("Confidence", labels = c("high confidence", "low confidence", "ambiguous")) +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05)),
limits = c(0, 100)) +
labs(x = NULL, y = "Participants",
fill = "Confidence",
title = "Overall participant's confidence when success (NW)") +
theme(legend.position = "top",
axis.ticks.x = element_blank())
p <- ggplot(accu_confi_no, aes(x = light_dir, y = pct, fill = confidence))
p + geom_bar(stat = "identity", color = "gray80") +
scale_fill_viridis_d("Confidence", labels = c("high confidence", "low confidence", "ambiguous")) +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05)),
limits = c(0, 100)) +
labs(x = NULL, y = "Participants",
fill = "Confidence",
title = "Overall participant's confidence when failure (NW)") +
theme(legend.position = "top",
axis.ticks.x = element_blank())
