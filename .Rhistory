accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_minimal_hgrid() +
theme(legend.position = "NULL")
theme(
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"))
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_minimal_hgrid() +
theme(legend.position = "NULL") +
theme(
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"))
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_minimal_hgrid() +
theme(
legend.position = "NULL", +
strip.background = element_blank(),
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_minimal_hgrid() +
theme(
legend.position = "NULL",
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"))
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_minimal_hgrid() +
theme(
# legend.position = "NULL",
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"))
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_minimal_hgrid() +
theme(
legend.position = "NULL",
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"))
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_minimal_hgrid() +
theme(
legend.position = "NULL",
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_minimal_hgrid() +
theme(
legend.position = "NULL",
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_minimal_hgrid() +
theme(
legend.position = "NULL",
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_dviz_hgrid() +
theme(
legend.position = "NULL",
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"),
axis.ticks.x = element_blank())
# Calculating accuracy per respond
accu_resp_j <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "j") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 27 * 100)
accu_resp_g <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "g") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 35 * 100)
accu_resp_v <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "v") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 87 * 100)
accu_resp_a <- df_long_clean %>%
filter(accuracy == "yes",
ds_owner == "a") %>%
group_by(ds_owner, landform, land_dir, light_dir) %>%
summarise(accu_count = n()) %>%
mutate(accu_pct = accu_count / 41 * 100)
accu_resp <- rbind(accu_resp_j, accu_resp_g, accu_resp_v, accu_resp_a)
# Calculating accuracy mean per light direction
accu_resp_north <- accu_resp %>%
group_by(ds_owner, light_dir) %>%
summarise(mean = mean(accu_pct))
accu_resp_north <- within(accu_resp_north, ds_owner <- factor(ds_owner, levels = c("j", "g", "v", "a")))
accu_resp_north <- within(accu_resp_north, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- within(df_long_clean, light_dir <- factor(light_dir, levels = c(0, 337.5, 315, 292.5, 270)))
# df_long_clean$light_dir <- ordered(df_long_clean$light_dir, levels = c(0, 337.5, 315, 292.5, 270))
p <- ggplot(accu_resp_north, aes(x = light_dir, y = mean, fill = light_dir, label = mean))
p + geom_bar(stat = "identity", alpha = .9) +
scale_fill_brewer(type = "qual", palette = "Dark2") +
scale_y_continuous(labels = scales::label_percent(scale = 1),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Light Direction", y = "Mean Accuracy",
fill = "Light Direction",
title = "Mean accuracy per data set owner") +
geom_text(aes(y = mean, label = round(mean, digits = 1)), position = position_dodge2(width = 1), vjust = 2, size = rel(3), family = dviz_font_family) +
facet_wrap(~ ds_owner) +
theme_minimal_hgrid() +
theme(
legend.position = "NULL",
strip.background = element_blank(),
axis.line.x.bottom = element_line(size = .3, color = "black"),
axis.ticks.x = element_blank())
